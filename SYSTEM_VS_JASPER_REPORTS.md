# System Reports vs. Jasper Reports

This document categorizes the reporting capabilities of the system into "System Reports" (generated by internal backend logic and rendered in the Frontend) and "Jasper Reports" (generated by the Java-based Jasper Service for PDF/Printable output).

## 1. System Reports (Internal/Frontend)
These reports are generated by the Elixir backend (`baraba_umbrella`) or helper services (Nim) and are typically displayed as interactive tables or downloadable regulatory files.

| Report Name | Description | Key Backend Function | Frontend Usage |
|-------------|-------------|----------------------|----------------|
| **Turnover by Counterpart** | Shows total debit, credit, and balance for each counterpart within a period. *Note: This was the source of the crash in CounterpartsPage.* | `Accounting.get_counterpart_turnover/3` | `CounterpartsPage.tsx` (Modal) |
| **VAT Return Files** | Generates regulatory TXT files for BG tax authorities (POKUPKI, PRODAGBI, DEKLAR). | `BarabaUmbrella.VatService.generate_vat_files/2` (calls Nim `vat_service`) | `VatReturnPage` / `VatReturnController` |
| **Currency Revaluation Preview** | Calculates potential FX gains/losses for open positions before posting. | `Accounting.preview_currency_revaluation/3` | `CurrencyRevaluationPage` |
| **Stock Levels** | Lists current inventory quantities and values. | `Accounting.list_stock_levels/3` | Stock Management UI |
| **Stock Movements** | History of stock entries and exits. | `Accounting.list_stock_movements/3` | Stock Management UI |
| **VIES Validation** | Real-time check of VAT numbers against EU database. | `BarabaUmbrella.ViesService.validate_vat/1` | Counterpart Forms |

## 2. Jasper Reports (PDF/Printable)
These reports are defined in `.jrxml` templates and generated via the `jasper_service`. They are primarily for printing and formal documentation.

| Report Name (ID) | Description | Template File |
|------------------|-------------|---------------|
| **Balance Sheet** | Standard Balance Sheet statement. | `balance_sheet.jrxml` / `balance_sheet_new.jrxml` |
| **Income Statement** | Profit and Loss statement. | `income_statement.jrxml` |
| **Trial Balance** | Summary of all account balances. | `trial_balance.jrxml` / `trial_balance_6col.jrxml` |
| **Journal Entries** | Detailed list of journal entries (Standard). | `journal_entries.jrxml` |
| **Chronological Journal** | Journal entries ordered by time (Chronological). | `journal_chronological.jrxml` |
| **Counterparts List** | A simple directory list of counterparts (Name, VAT, Address). *Not to be confused with Turnover Report.* | `counterparts.jrxml` |

## Summary of Findings
- The **Turnover by Counterpart** report is **NOT deleted**. It is a **System Report** integrated into the Counterparts page (via the "Turnover" / "Оборот" button).
- The crash you experienced (`TypeError: Cannot read properties of undefined (reading 'map')`) was caused by the Turnover Report modal receiving invalid data. This has been patched.
- The `counterparts.jrxml` in Jasper is only a contact list, not a financial turnover report.
